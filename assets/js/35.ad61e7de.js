(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{342:function(t,a,s){"use strict";s.r(a);var n=s(33),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"webpack构建速度及体积优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webpack构建速度及体积优化"}},[t._v("#")]),t._v(" webpack构建速度及体积优化")]),t._v(" "),s("h2",{attrs:{id:"分析（初级）-使用webpack内置的stats"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析（初级）-使用webpack内置的stats"}},[t._v("#")]),t._v(" 分析（初级）-使用webpack内置的stats")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("引入")]),t._v(" "),s("p",[t._v("stats: 构建的统计信息")]),t._v(" "),s("p",[t._v("缺点：颗粒度太粗，看不出问题在哪")])]),t._v(" "),s("h3",{attrs:{id:"stats-使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stats-使用"}},[t._v("#")]),t._v(" stats 使用")]),t._v(" "),s("p",[s("code",[t._v("package.json")]),t._v("中使用"),s("code",[t._v("stats")])]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build:stats"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack --env production --json > stats.json"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"分析（速度）-使用-speed-measure-webpack-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析（速度）-使用-speed-measure-webpack-plugin"}},[t._v("#")]),t._v(" 分析（速度）-使用 "),s("a",{attrs:{href:"https://github.com/stephencookdev/speed-measure-webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("speed-measure-webpack-plugin"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("特点")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("分析整个打包总耗时")])]),t._v(" "),s("li",[s("p",[t._v("每个插件和loader的耗时情况")])])])]),t._v(" "),s("h3",{attrs:{id:"插件使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件使用"}},[t._v("#")]),t._v(" 插件使用")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("安装")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("npm i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev speed"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("measure"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("webpack"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin\n")])])]),s("p",[t._v("or")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("yarn add speed"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("measure"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("webpack"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("dev\n")])])])]),t._v(" "),s("li",[s("p",[t._v("接入")]),t._v(" "),s("p",[t._v("在webpack配置文件中引入"),s("code",[t._v("speed-measure-webpack-plugin")]),t._v(";")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" speedMeasureWebpackPlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'speed-measure-webpack-plugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" smp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("speedMeasureWebpackPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" smp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("像上面的例子一样，使用插件中的"),s("code",[t._v("wrap")]),t._v("方法将内容包裹起来，在打包完成之后就能看到模块间的时间。")])])]),t._v(" "),s("p",[s("a",{attrs:{"data-fancybox":"",title:"速度分析",href:"https://img-blog.csdnimg.cn/2020042710203448.png"}},[s("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020042710203448.png",alt:"速度分析"}})])]),t._v(" "),s("h2",{attrs:{id:"分析（体积）-使用-webpack-bundle-analyzer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析（体积）-使用-webpack-bundle-analyzer"}},[t._v("#")]),t._v(" 分析（体积）-使用 "),s("a",{attrs:{href:"https://github.com/webpack-contrib/webpack-bundle-analyzer",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack-bundle-analyzer"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("作用")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("依赖的第三方模块文件大小")])]),t._v(" "),s("li",[s("p",[t._v("业务里面的组件代码大小")])])])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("安装")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("npm i webpack"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("bundle"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("analyzer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("D")]),t._v("\n")])])]),s("p",[t._v("or")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("yarn add webpack"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("bundle"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("analyzer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("D")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("接入")]),t._v(" "),s("p",[t._v("在webpack配置文件中引入"),s("code",[t._v("webpack-bundle-analyzer")]),t._v(";")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" BundleAnalyzerPlugin "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webpack-bundle-analyzer'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" smp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BundleAnalyzerPlugin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("p",[t._v("在构建完成之后可以访问本地8888端口（默认可修改），查看当前项目文件的体积关系")]),t._v(" "),s("h2",{attrs:{id:"优化（速度）-使用-高版本的-webpack-和-node-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优化（速度）-使用-高版本的-webpack-和-node-js"}},[t._v("#")]),t._v(" 优化（速度）-使用 高版本的 webpack 和 Node.js")]),t._v(" "),s("h2",{attrs:{id:"优化（速度）-多进程-多实例构建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优化（速度）-多进程-多实例构建"}},[t._v("#")]),t._v(" 优化（速度）-多进程/多实例构建")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("可选方案")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("thread-loader")])]),t._v(" "),s("li",[s("p",[t._v("parallel-webpack")])]),t._v(" "),s("li",[s("p",[t._v("HappyPack")])])])]),t._v(" "),s("h3",{attrs:{id:"使用-happypack-解析资源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-happypack-解析资源"}},[t._v("#")]),t._v(" 使用 "),s("a",{attrs:{href:"https://github.com/amireh/happypack",target:"_blank",rel:"noopener noreferrer"}},[t._v("HappyPack"),s("OutboundLink")],1),t._v(" 解析资源")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("原理")]),t._v(" "),s("p",[t._v("每次 webpack 解析一个模块，HappyPack 会将它及它的依赖分配给 worker 线程中")])]),t._v(" "),s("h3",{attrs:{id:"使用-thread-loader-解析资源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-thread-loader-解析资源"}},[t._v("#")]),t._v(" 使用 "),s("a",{attrs:{href:"https://github.com/webpack-contrib/thread-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("thread-loader"),s("OutboundLink")],1),t._v(" 解析资源")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("原理")]),t._v(" "),s("p",[t._v("每次 webpack 解析一个模块，thread-loader 会将它及它的依赖分配给worker线程中")])]),t._v(" "),s("h2",{attrs:{id:"优化（体积）-多进程-多实例：并行压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优化（体积）-多进程-多实例：并行压缩"}},[t._v("#")]),t._v(" 优化（体积）-多进程/多实例：并行压缩")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("使用 "),s("a",{attrs:{href:"https://github.com/gdborton/webpack-parallel-uglify-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("parallel-uglify-plugin"),s("OutboundLink")],1),t._v(" 插件")])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://github.com/webpack-contrib/uglifyjs-webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("uglifyjs-webpack-plugin"),s("OutboundLink")],1),t._v(" 开启 "),s("code",[t._v("parallel")]),t._v(" 参数 （webpack 4 版本之前）")])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://github.com/webpack-contrib/terser-webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("terser-webpack-plugin"),s("OutboundLink")],1),t._v(" 开启 "),s("code",[t._v("parallel")]),t._v(" 参数 （webpack 4 版本之后）")])])]),t._v(" "),s("h2",{attrs:{id:"进一步分包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进一步分包"}},[t._v("#")]),t._v(" 进一步分包")]),t._v(" "),s("h3",{attrs:{id:"设置-externals-初级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置-externals-初级"}},[t._v("#")]),t._v(" 设置 Externals (初级)")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("思路")]),t._v(" "),s("p",[t._v("将 react、react-dom 基础包通过 cdn 引入，不打入 bundle 中")]),t._v(" "),s("p",[t._v("方法: 使用 html-webpack-externals-plugin")])]),t._v(" "),s("h3",{attrs:{id:"预编译资源模块-高级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#预编译资源模块-高级"}},[t._v("#")]),t._v(" 预编译资源模块 (高级)")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("思路")]),t._v(" "),s("p",[t._v("思路：将 react、react-dom、redux、react-redux 基础包和业务基础包打包成一个文件")]),t._v(" "),s("p",[t._v("方法：使用 DLLPlugin 进行分包， DIIReferencePlugin 对 manifest.json 引用")])]),t._v(" "),s("ol",[s("li",[s("p",[t._v("创建"),s("code",[t._v("webpack.dll.js")]),t._v("文件")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" webpack "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webpack'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    entry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 基础包")]),t._v("\n        library"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react-dom'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果还有其他类可以在这里加一个键和对象")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    output"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        filename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name]_[chunkhash].dll.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'build/library'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        library"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name]'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("webpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DllPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[name]_[hash]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            path"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'build/library/[name].json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("文件用于分包，将一些基础包进行分离")])]),t._v(" "),s("li",[s("p",[t._v("引入分离包")]),t._v(" "),s("p",[t._v("首先可以在"),s("code",[t._v("package.json")]),t._v("中的"),s("code",[t._v("scripts")]),t._v("添加一项")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dll"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"webpack --config webpack.dll.js"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("然后在打包配置文件中增加：")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" webpack "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'webpack'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        plugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("webpack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DllReferencePlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                manifest"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./build/library/library.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"利用缓存提高二次构建速度"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#利用缓存提高二次构建速度"}},[t._v("#")]),t._v(" 利用缓存提高二次构建速度")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("缓存思路")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("babel-loader 开启缓存")])]),t._v(" "),s("li",[s("p",[t._v("terser-webpack-plugin 开启缓存")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    optimization"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        minimizer"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TerserPlugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                parallel"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                cache"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("使用 cache-loader 或者 hard-source-webpack-plugin")])])])]),t._v(" "),s("h2",{attrs:{id:"缩小构建目标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#缩小构建目标"}},[t._v("#")]),t._v(" 缩小构建目标")]),t._v(" "),s("h3",{attrs:{id:"减少文件搜索范围"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#减少文件搜索范围"}},[t._v("#")]),t._v(" 减少文件搜索范围")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("优化 resolve.modules 配置 （减少模块搜索层级）")])]),t._v(" "),s("li",[s("p",[t._v("优化 resolve.mainFields 配置")])]),t._v(" "),s("li",[s("p",[t._v("优化 resolve.extensions 配置")])]),t._v(" "),s("li",[s("p",[t._v("合理使用 alias")])])]),t._v(" "),s("h2",{attrs:{id:"使用-tree-shaking-擦除无用的javascript和css"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-tree-shaking-擦除无用的javascript和css"}},[t._v("#")]),t._v(" 使用 Tree Shaking 擦除无用的JavaScript和CSS")]),t._v(" "),s("h3",{attrs:{id:"无用的css如何删除掉"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#无用的css如何删除掉"}},[t._v("#")]),t._v(" 无用的CSS如何删除掉")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("PurifyCSS: 遍历代码，识别已经用到的 CSS class")]),t._v(" "),s("p",[t._v("如何在 webpack 中使用 PurifyCSS")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v(" 使用 `purgecss-webpack-plugin` 和 `mini-css-extract-plugin` 配合使用\n")])])])]),t._v(" "),s("p",[t._v("(1) 安装")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    npm i purgecss"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("webpack"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("D")]),t._v("\n")])])]),s("p",[t._v("or")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("    yarn add purgecss"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("webpack"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("plugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("D")]),t._v("\n")])])]),s("p",[t._v("在webpack配置文件中使用：")]),t._v(" "),s("div",{staticClass:"language-javaScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" PurgecssPlugin "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'purgecss-webpack-plugin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PATHS")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'src'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\nplugins"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PurgecssPlugin")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这里的glob类似我们之前那种多页面打包的方式获取对应文件")]),t._v("\n        paths"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" glob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PATHS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("/**/*")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" nodir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[s("a",{attrs:{href:"https://github.com/FullHuman/purgecss/tree/master/packages/purgecss-webpack-plugin",target:"_blank",rel:"noopener noreferrer"}},[t._v("purgecss-webpack-plugin"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("uncss: HTML 需要通过 jsdom 加载，所有的样式通过 PostCSS 解析，通过 document.querySelector 来识别在 html 文件里面不存在的选择器")])])]),t._v(" "),s("h2",{attrs:{id:"使用webpack进行图片压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用webpack进行图片压缩"}},[t._v("#")]),t._v(" 使用webpack进行图片压缩")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("要求：基于Node库的 "),s("code",[t._v("imagemin")]),t._v(" 或者 "),s("code",[t._v("tinypng")]),t._v(" API")]),t._v(" "),s("p",[t._v("使用：配置 "),s("a",{attrs:{href:"https://github.com/tcoopman/image-webpack-loader",target:"_blank",rel:"noopener noreferrer"}},[t._v("image-webpack-loader"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Imagemin 的优点分析")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("有很多定制选项")])]),t._v(" "),s("li",[s("p",[t._v("可以引入更多第三方优化插件，例如pngquart")])]),t._v(" "),s("li",[s("p",[t._v("可以处理多种图片格式")])])])]),t._v(" "),s("h2",{attrs:{id:"使用polyfill"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用polyfill"}},[t._v("#")]),t._v(" 使用Polyfill")])])}),[],!1,null,null,null);a.default=e.exports}}]);